#!/bin/sh
# .sh_commons - common settings for shells

#                                  ALIAS                                  {{{1
# ============================================================================

alias pm-hibernate='echo "NEVER USE IT!"'
alias ls='ls -Av --color --group-directories-first'
alias grep='grep --color'
alias du='du -b'
alias o='xdg-open'
alias g='git'
__git_complete g __git_main
alias shall='shdo run !ALL'
alias mvim='vim -u ~/.vimrc_minimal'

# Disable .vimrc in vim.tiny because of incompatible settings.
if [[ $(which vim.tiny 2> /dev/null) ]]; then
  alias vim.tiny='vim.tiny -u NONE'
fi

# Do not close the image after gnuplot.
if [[ $(which gnuplot 2> /dev/null) ]]; then
  alias gnuplot='gnuplot -persist'
fi

#                          ENVIRONMENT VARIABLES                          {{{1
# ============================================================================

# Add ~/bin to $PATH.
if [[ ! $PATH =~ $HOME/bin ]]; then
  export PATH=$HOME/bin:$PATH
fi
if [[ ! $PATH =~ $HOME/.gitconfig_files/custom_commands ]]; then
  export PATH=$HOME/.gitconfig_files/custom_commands:$PATH
fi

if [[ -z $EDITOR ]]; then
  export EDITOR="nvim-qt --nofork"
fi

# View manuals in vim.
export MANPAGER="/bin/sh -c \"unset PAGER; col -b -x |         \
                 vim -R                                        \
                 -c 'set nocp'                                 \
                 -c 'filetype plugin on'                       \
                 -c 'syntax enable'                            \
                 -c 'runtime ftplugin/man.vim'                 \
                 -c 'set ft=man ls=0 nosmd nonu nornu nolist'  \
                 -c 'map <CR> <C-]>'                           \
                 -c 'map q :q<CR>' - \""

# FZF default options
export FZF_DEFAULT_OPTS="--exact --multi"

#                                FUNCTIONS                                {{{1
# ============================================================================

# Start program then give back the prompt (to run programs with GUI).
x()
{
  nohup $* &> /dev/null &
}

# English-hungarian dictionary, download:
# https://github.com/BimbaLaszlo/dotvim/blob/master/doc/szotar.txt
szotar()
{
  if [[ -e $HOME/.vim_local/bundle/dotvim/doc/szotar.txt ]]; then
    grep "$@" $HOME/.vim_local/bundle/dotvim/doc/szotar.txt
  else
    echo "ERROR: missing dictionary $HOME/.vim_local/bundle/dotvim/doc/szotar.txt"
  fi
}
